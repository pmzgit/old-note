# 分布式系统
### 分类
1. 分布式存储系统
    1. 结构化存储
    2. 非结构化存储
    3. 半结构化存储
    4. In-memory 存储
2. 分布式计算系统
    1. 传统基于msg的系统
    2. MapReduce-like 系统
    3. 图计算系统
    4. 基于状态（state）的系统
    5. Streaming 系统
3. 分布式管理系统


# 消息队列
* 是一种进程间通信或同一进程的不同线程间的**通信方式**，软件的贮列用来处理一系列的输入，通常是来自用户。消息队列提供了**异步**的通信协议，每一个贮列中的纪录包含详细说明的数据，包含发生的时间，输入设备的种类，以及特定的输入参数，也就是说：消息的发送者和接收者不需要同时与消息队列互交。消息会保存在队列中，直到接收者取回它。[1]
* 但消息队列的异步特点，也造成了一个缺点，就是接收者必须轮询消息队列，才能收到最近的消息。
和**信号**相比，消息队列能够传递更多的信息。与**管道**相比，消息队列提供了有格式的数据，这可以减少开发人员的工作量。[2]但消息队列仍然有大小限制。
消息队列除了可以当不同线程或进程间的缓冲外，更可以通过消息队列当前消息数量来侦测接收线程或进程性能是否有问题

# 设计模式：发布/订阅模式解析
这个模式用来作为中间人，一个把发布者和订阅者架接在一起的代理。发布者是当完成某些过程的时候触发事件的对象，订阅者是希望当发布者发布的时候希望被通知的对象。
 * 发布/订阅者模式实现了松耦合：你可以让发布者发布消息，订阅者接受消息而不是寻找一种方式把两个分离的系统连接在一起。

# 中间件
* 就是 非业务的技术类组件。

# 分布式任务调度-数据处理的场景

a)时间驱动/事件驱动：内部系统一般可以通过时间来驱动，但涉及到外部系统，则只能使用事件驱动。如怕取外部网站价格，每小时爬一次  
b)批量处理/逐条处理：批量处理堆积的数据更加高效，在不需要实时性的情况下比消息中间件更有优势。而且有的业务逻辑只能批量处理。如移动每个月结算我们的话费  
c)实时性/非实时性：消息中间件能够做到实时处理数据，但是有些情况下并不需要实时，比如：vip升级  
d)系统内部/系统解耦：定时任务调度一般是在系统内部，而消息中间件可用于两个系统间  

# [幂等操作实现](https://825635381.iteye.com/blog/2276077)
## why
* 在分布式环境中，网络环境更加复杂，因前端操作抖动、网络故障、消息重复、响应速度慢等原因，对接口的重复调用概率会比集中式环境下更大，尤其是重复消息在分布式环境中很难避免。

* 网络通信可能会包含，成功、失败以及超时三种情况。
## how
数据库联合唯一索引  
分布式锁  
幂等友好 对请求加锁，业务结果，直接返回，阻塞等待
https://825635381.iteye.com/blog/2276077


